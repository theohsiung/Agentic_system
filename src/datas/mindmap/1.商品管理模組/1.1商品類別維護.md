# 1. 功能概述 (Overview)
商品类别维护功能提供貨主對商品類別資料進行新增、修改、刪除、查詢。並在後端維持資料唯一性，
同步資料庫、Redis 快取，並對外發布商品類別事件，確保系統間資料一致性。

# 2. 版本紀錄 (Revision History)
| 修訂內容     | 版本 | 作者    | 日期       |
| ------------ | ---- | ------- | ---------- |
| 公版初版     | V1.0 | tong    | 2025.3.20  |
| 新增前端邏輯 | V1.1 | Stanley | 2025.4.2   |

# 3. 功能範圍 (Scope)
- 新增商品類別
- 修改商品類別
- 刪除商品類別
- 查詢商品類別

# 4. 詳細規格 (Specifications)

## 4.1 新增商品類別 (Create)
### 4.1.1 校驗規則
1. 類別編號不得重複 → “類別[{0}]不可重複”

### 4.1.2 後端邏輯
1. 根據類別編號生成類別物件  
2. 填入基本資料：類別名稱、建立人、建立時間  
3. 寫入資料庫  
4. 發布事件：`EventName.CreateProductCategory` (Hand)  
5. 加入 Redis 快取  
6. 貨主使用次數 +1  

---

## 4.2 修改商品類別 (Update)
### 4.2.1 校驗規則
- 無額外校驗規則

### 4.2.2 後端邏輯
1. 依 ID 取得現有類別物件  
2. 更新資料（類別名稱）  
3. 保存至資料庫  
4. 發布事件：`EventName.UpdateProductCategory` (Hand)  
5. 更新 Redis 快取  

---

## 4.3 刪除商品類別 (Delete)
### 4.3.1 校驗規則
1. 資料是否存在 → “當前資料已不存在，請重新查詢！”  
2. 類別是否被商品引用 → “[{0}]已被其它資料引用，不允許刪除！”

### 4.3.2 後端邏輯
1. 依 S_ID 取得類別物件  
2. 自資料庫刪除  
3. 發布事件：`EventName.DeleteProductCategory` (Hand)  
4. 更新 Redis 快取  
5. 貨主使用次數 −1  

---

## 4.4 查詢商品類別 (Query)
### 4.4.1 支援的查詢欄位
- 貨主編號  
- 類別編號  
- 類別名稱（模糊查詢）  

### 4.4.2 排序規則
- 按 **類別編號** 由小到大排序  

---

# 5. 系統事件 (Domain Events)
- CreateProductCategory  
- UpdateProductCategory  
- DeleteProductCategory  
（皆由 Hand 發布）

# 6. 快取 (Redis Cache) 行為
- 新增：寫入 Redis  
- 修改：更新 Redis  
- 刪除：更新 Redis（移除）  

# 7. 其它邏輯
- 新增時貨主使用次數 +1  
- 刪除時貨主使用次數 −1  
- 刪除前需確認是否被引用  

# 8. 前端 (Frontend)
### 8.1 校驗邏輯
#### ＜類別編號＞ → 按下 ＜Enter＞
- 校驗「貨主編號 + 類別編號」是否重複